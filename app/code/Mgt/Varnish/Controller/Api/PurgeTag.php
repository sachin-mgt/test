<?php
 namespace Mgt\Varnish\Controller\Api; class PurgeTag extends \Magento\Framework\App\Action\Action { protected $cachePurger; protected $config; public function __construct(\Magento\Framework\App\Action\Context $context, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Mgt\Varnish\Model\Cache\Config $config) { goto ce39c; ce39c: $this->cachePurger = $cachePurger; goto F2345; c8bc9: parent::__construct($context); goto C16ef; F2345: $this->config = $config; goto c8bc9; C16ef: } public function execute() { goto fb5ec; a885a: $response->setHeader("\x43\157\156\x74\145\x6e\x74\x2d\124\171\x70\145", "\x61\160\x70\x6c\151\143\141\x74\151\157\x6e\57\x6a\x73\157\156"); goto cf6fd; cf6fd: $response->setBody($body); goto f1c55; Ee1f0: try { goto dba93; a384f: $tags = [$tag]; goto ee65c; Af26f: F501f: goto a384f; dba93: $apiSecretKey = $this->config->getApiSecretKey(); goto A56a5; Ecd3c: throw new \Exception("\123\x65\143\x72\x65\164\x20\x61\x70\151\x20\x6b\145\x79\40\x69\163\x20\156\x6f\164\40\x63\157\162\162\x65\x63\164"); goto Af26f; d74df: $body = ["\x73\165\143\x63\x65\x73\x73" => 1, "\x6d\145\x73\x73\x61\147\x65" => sprintf("\x56\x61\162\x6e\151\x73\x68\x20\103\141\x63\150\145\x20\160\165\162\x67\145\x64\x20\x62\171\x20\x66\x6f\154\154\x6f\x77\151\156\x67\x20\164\141\x67\x3a\40\45\163", $tag)]; goto F23e1; A56a5: if (!($secretKey != $apiSecretKey)) { goto F501f; } goto Ecd3c; ee65c: $this->cachePurger->sendPurgeRequest($tags); goto d74df; F23e1: } catch (\Exception $e) { $errorMessage = $e->getMessage(); $body = ["\163\x75\143\143\145\163\163" => 0, "\x6d\x65\x73\x73\x61\x67\x65" => $errorMessage]; } goto A801c; b70a9: $response = $this->getResponse(); goto b0cfd; f1c55: $response->sendResponse(); goto ee4e6; ee4e6: exit; goto Cd1ce; A801c: D39e4: goto D580e; b0cfd: $body = []; goto D8af5; fb5ec: $request = $this->getRequest(); goto b70a9; a3a60: if (!($secretKey && $tag)) { goto D39e4; } goto Ee1f0; D8af5: $secretKey = $request->getParam("\163\x65\143\162\x65\164\x4b\x65\171"); goto F8645; F8645: $tag = $request->getParam("\x74\141\x67"); goto a3a60; D580e: $body = json_encode($body); goto a885a; Cd1ce: } }
